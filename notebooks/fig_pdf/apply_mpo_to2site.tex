% type:
% pdftocairo -svg "apply_mpo_to2site.pdf" "apply_mpo_to2site.svg"

% Dec 16, 2018
% Adapted from https://truonglatex.wordpress.com/2011/11/28/create-standalone-figures-which-are-input-able/
\documentclass[tikz,convert={outext=.png}]{standalone}
%\usepackage{tikz}
%\usepackage{mypackage}
%\input{mydefs}

\begin{document}

\definecolor{tensoryellow}{rgb}{1, 1, 0}
\tikzset{ten/.style={fill=tensoryellow}}


\begin{tikzpicture}[a/.style={fill=yellow!40},scale=.6,every node/.style={sloped,allow upside down},baseline={([yshift=-.8ex]current bounding box.center)}]
			\def\a{1.5} % width and height of tensors A1 and A 2
			\def\b{5.5} % width of the operator
			\def\dx{1} % length of the lines

			\def\x0{\b/2-\a/2}

			% draw matrix opearator U (with 4 indices):
			\filldraw[ten, shift={(\x0,0)}] (-\b/2,-\a/2) -- (-\b/2,\a/2) -- (\b/2,\a/2) -- (\b/2,-\a/2) -- (-\b/2,-\a/2);
			\draw (0,-\a/2-\dx/2) -- (0,-\a/2);
			\draw[shift={(0,2)}] (0,-\a/2-\dx/2) -- (0,-\a/2);
			\draw[shift={(\b-\a,0)}] (0,-\a/2-\dx/2) -- (0,-\a/2);
			\draw[shift={(\b-\a,2)}] (0,-\a/2-\dx/2) -- (0,-\a/2);
			
			\draw (\b/2-\a/2,0) node {$\scriptstyle U$};
			
			\draw (0,-1.75) node {$ n $};
			\draw (\b-\a,-1.75) node {$ r $};			
			\draw (0,1.75) node {$ j $};	
			\draw (\b-\a,1.75) node {$ l $};					


			% draw original tensor A1 (with 3 indices):

			\def\y{5}

			\filldraw[ten, shift={(0,\y)}] (-\a/2,-\a/2) -- (-\a/2,\a/2) -- (\a/2,\a/2) -- (\a/2,-\a/2) -- (-\a/2,-\a/2);
			\draw[shift={(0,\y)}] (0,-\a/2-\dx/2) -- (0,-\a/2);
			\draw[shift={(0,\y)}]  (-\a/2-\dx/2,0) -- (-\a/2,0);
			\draw[shift={(2,\y)}] (-\a/2-\dx/2,0) -- (-\a/2,0);
			
			\draw[shift={(0,\y)}] (0,0) node {$\scriptstyle A_1$};
			
			\draw[shift={(0,\y)}]  (-1.25,0.5) node {$ i $};
			\draw[shift={(0,\y)}]  (0,-1.75) node {$ j $};
			\draw[shift={(0,\y)}]  (1.25,0.5) node {$ k $};			

			% draw original tensor A2 (with 3 indices):

			\def\y{5}
			\def\x2{4} % distance between tensors A1 and A2

			\filldraw[ten, shift={(\x2,\y)}] (-\a/2,-\a/2) -- (-\a/2,\a/2) -- (\a/2,\a/2) -- (\a/2,-\a/2) -- (-\a/2,-\a/2);
			\draw[shift={(\x2,\y)}] (0,-\a/2-\dx/2) -- (0,-\a/2);
			\draw[shift={(\x2,\y)}]  (-\a/2-\dx/2,0) -- (-\a/2,0);
			\draw[shift={(\x2+2,\y)}] (-\a/2-\dx/2,0) -- (-\a/2,0);
			
			\draw[shift={(\x2,\y)}] (0,0) node {$\scriptstyle A_2$};
			
			\draw[shift={(\x2,\y)}]  (-1.25,0.5) node {$ k $};
			\draw[shift={(\x2,\y)}]  (0,-1.75) node {$ l $};
			\draw[shift={(\x2,\y)}]  (1.25,0.5) node {$ m $};			



			% draw new tensor B  (with 5 indices):

			\def\y{2.75}
			\def\x{10}

			\draw[shift={(\x - 3,\y)}] (0,0) node {$ = $};

			\filldraw[ten, shift={(\x,\y)}] (-\a/2,-\a/2) -- (-\a/2,\a/2) -- (\a/2*3,\a/2) -- (\a/2*3,-\a/2) -- (-\a/2,-\a/2);

			\draw[shift={(\x,\y)}] (0,-\a/2-\dx/2) -- (0,-\a/2);
			\draw[shift={(\x+\a,\y)}] (0,-\a/2-\dx/2) -- (0,-\a/2);

			\draw[shift={(\x,\y)}]  (-\a/2-\dx/2,0) -- (-\a/2,0);
			\draw[shift={(2+\x+\a,\y)}] (-\a/2-\dx/2,0) -- (-\a/2,0);
			%\draw[shift={(\x,\y+1.5)}]  (-\a/2-\dx/2,0) -- (-\a/2,0);
			%\draw[shift={(2+\x+\a,\y+1.5)}] (-\a/2-\dx/2,0) -- (-\a/2,0);

			
			\draw[shift={(\x+\a/2,\y)}] (0,0) node {$\scriptstyle B$};
			
			%\draw[shift={(\x,\y)}]  (-1.25,2.) node {$ p $};
			\draw[shift={(\x,\y)}]  (-1.25,0.5) node {$ i $};
			\draw[shift={(\x,\y)}]  (0,-1.75) node {$ n $};
			\draw[shift={(\x,\y)}]  (1.5,-1.75) node {$ r $};
			\draw[shift={(\x+\a,\y)}]  (1.25,0.5) node {$ m $};			
			%\draw[shift={(\x+\a,\y)}]  (1.25,2.) node {$ m $};			



			
\end{tikzpicture}

\end{document}
